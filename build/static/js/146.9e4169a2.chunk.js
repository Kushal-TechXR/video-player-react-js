"use strict";(self.webpackChunkreels_app=self.webpackChunkreels_app||[]).push([[146],{146:(t,s,e)=>{e.r(s),e.d(s,{GoogleCastProvider:()=>x});var i=e(705),a=e(790),n=e(149),h=e(562),o=e(458),c=e(558),r=e(180),l=e(408),A=e(674),d=(e(43),new WeakMap),u=new WeakSet;class m{constructor(t){(0,a.A)(this,u),(0,n.A)(this,d,void 0),(0,c.A)(d,this,new chrome.cast.media.MediaInfo(t.src,t.type))}build(){return(0,o.A)(d,this)}setStreamType(t){return t.includes("live")?(0,o.A)(d,this).streamType=chrome.cast.media.StreamType.LIVE:(0,o.A)(d,this).streamType=chrome.cast.media.StreamType.BUFFERED,this}setTracks(t){return(0,o.A)(d,this).tracks=t.map((0,h.A)(u,this,v)),this}setMetadata(t,s){return(0,o.A)(d,this).metadata=new chrome.cast.media.GenericMediaMetadata,(0,o.A)(d,this).metadata.title=t,(0,o.A)(d,this).metadata.images=[{url:s}],this}}function v(t,s){const e=new chrome.cast.media.Track(s,chrome.cast.media.TrackType.TEXT);return e.name=t.label,e.trackContentId=t.src,e.trackContentType="text/vtt",e.language=t.language,e.subtype=t.kind.toUpperCase(),e}var f=new WeakMap,p=new WeakMap,k=new WeakMap,T=new WeakSet;class y{constructor(t,s,e){(0,a.A)(this,T),(0,n.A)(this,f,void 0),(0,n.A)(this,p,void 0),(0,n.A)(this,k,void 0),(0,c.A)(f,this,t),(0,c.A)(p,this,s),(0,c.A)(k,this,e)}setup(){const t=this.syncRemoteActiveIds.bind(this);(0,r.k6)((0,o.A)(p,this).audioTracks,"change",t),(0,r.k6)((0,o.A)(p,this).textTracks,"mode-change",t),(0,r.QZ)((0,h.A)(T,this,C).bind(this))}getLocalTextTracks(){return(0,o.A)(p,this).$state.textTracks().filter(t=>t.src&&"vtt"===t.type)}syncRemoteTracks(t){if(!(0,o.A)(f,this).isMediaLoaded)return;const s=(0,h.A)(T,this,g).call(this),e=this.getLocalTextTracks(),i=(0,h.A)(T,this,E).call(this,chrome.cast.media.TrackType.AUDIO),a=(0,h.A)(T,this,E).call(this,chrome.cast.media.TrackType.TEXT);for(const c of i){var n;if((0,h.A)(T,this,S).call(this,s,c))continue;const e={id:c.trackId.toString(),label:c.name,language:c.language,kind:null!==(n=c.subtype)&&void 0!==n?n:"main",selected:!1};(0,o.A)(p,this).audioTracks[l.jH.add](e,t)}for(const c of a){if((0,h.A)(T,this,S).call(this,e,c))continue;const s={id:c.trackId.toString(),src:c.trackContentId,label:c.name,language:c.language,kind:c.subtype.toLowerCase()};(0,o.A)(p,this).textTracks.add(s,t)}}syncRemoteActiveIds(t){if(!(0,o.A)(f,this).isMediaLoaded)return;const s=(0,h.A)(T,this,w).call(this),e=new chrome.cast.media.EditTracksInfoRequest(s);(0,h.A)(T,this,M).call(this,e).catch(t=>{})}}function g(){return(0,o.A)(p,this).$state.audioTracks()}function E(t){var s,e;const i=null!==(s=null===(e=(0,o.A)(f,this).mediaInfo)||void 0===e?void 0:e.tracks)&&void 0!==s?s:[];return t?i.filter(s=>s.type===t):i}function w(){const t=[],s=(0,h.A)(T,this,g).call(this).find(t=>t.selected),e=this.getLocalTextTracks().filter(t=>"showing"===t.mode);if(s){const e=(0,h.A)(T,this,E).call(this,chrome.cast.media.TrackType.AUDIO),i=(0,h.A)(T,this,L).call(this,e,s);i&&t.push(i.trackId)}if(null!==e&&void 0!==e&&e.length){const s=(0,h.A)(T,this,E).call(this,chrome.cast.media.TrackType.TEXT);if(s.length)for(const i of e){const e=(0,h.A)(T,this,L).call(this,s,i);e&&t.push(e.trackId)}}return t}function C(){const t=this.getLocalTextTracks();if(!(0,o.A)(f,this).isMediaLoaded)return;const s=(0,h.A)(T,this,E).call(this,chrome.cast.media.TrackType.TEXT);for(const e of t){if(!(0,h.A)(T,this,L).call(this,s,e)){(0,r.vz)(()=>{var t;return null===(t=(0,o.A)(k,this))||void 0===t?void 0:t.call(this)});break}}}function M(t){const s=(0,A.Cs)();return new Promise((e,i)=>null===s||void 0===s?void 0:s.editTracksInfo(t,e,i))}function S(t,s){return t.find(t=>(0,h.A)(T,this,I).call(this,t,s))}function L(t,s){return t.find(t=>(0,h.A)(T,this,I).call(this,s,t))}function I(t,s){return s.name===t.label&&s.language===t.language&&s.subtype.toLowerCase()===t.kind.toLowerCase()}var b=new WeakMap,D=new WeakMap,_=new WeakMap,N=new WeakMap,P=new WeakMap,G=new WeakMap,R=new WeakMap,W=new WeakMap,O=new WeakMap,$=new WeakMap,V=new WeakMap,H=new WeakMap,U=new WeakSet;class x{constructor(t,s){(0,a.A)(this,U),(0,i.A)(this,"$$PROVIDER_TYPE","GOOGLE_CAST"),(0,i.A)(this,"scope",(0,r.Ds)()),(0,n.A)(this,b,void 0),(0,n.A)(this,D,void 0),(0,n.A)(this,_,void 0),(0,n.A)(this,N,null),(0,n.A)(this,P,"disconnected"),(0,n.A)(this,G,0),(0,n.A)(this,R,0),(0,n.A)(this,W,new l.zJ(0,0)),(0,n.A)(this,O,new l.e8((0,h.A)(U,this,B).bind(this))),(0,n.A)(this,$,void 0),(0,n.A)(this,V,null),(0,n.A)(this,H,!1),(0,c.A)(b,this,t),(0,c.A)(D,this,s),(0,c.A)(_,this,new y(t,s,(0,h.A)(U,this,ut).bind(this)))}get type(){return"google-cast"}get currentSrc(){return(0,o.A)(N,this)}get player(){return(0,o.A)(b,this)}get cast(){return(0,A.vY)()}get session(){return(0,A.aQ)()}get media(){return(0,A.Cs)()}get hasActiveSession(){return(0,A.Qg)((0,o.A)(N,this))}setup(){(0,h.A)(U,this,z).call(this),(0,h.A)(U,this,J).call(this),(0,o.A)(_,this).setup(),(0,o.A)(D,this).notify("provider-setup",this)}async play(){var t;((0,o.A)(b,this).isPaused||(0,o.A)(H,this))&&((0,o.A)(H,this)?await(0,h.A)(U,this,dt).call(this,!1,0):null===(t=(0,o.A)(b,this).controller)||void 0===t||t.playOrPause())}async pause(){var t;(0,o.A)(b,this).isPaused||null===(t=(0,o.A)(b,this).controller)||void 0===t||t.playOrPause()}getMediaStatus(t){return new Promise((s,e)=>{var i;null===(i=this.media)||void 0===i||i.getStatus(t,s,e)})}setMuted(t){var s;(t&&!(0,o.A)(b,this).isMuted||!t&&(0,o.A)(b,this).isMuted)&&(null===(s=(0,o.A)(b,this).controller)||void 0===s||s.muteOrUnmute())}setCurrentTime(t){var s;(0,o.A)(b,this).currentTime=t,(0,o.A)(D,this).notify("seeking",t),null===(s=(0,o.A)(b,this).controller)||void 0===s||s.seek()}setVolume(t){var s;(0,o.A)(b,this).volumeLevel=t,null===(s=(0,o.A)(b,this).controller)||void 0===s||s.setVolumeLevel()}async loadSource(t){var s;if((null===(s=(0,o.A)(V,this))||void 0===s?void 0:s.src)!==t&&(0,c.A)(V,this,null),(0,A.Qg)(t))return(0,h.A)(U,this,F).call(this),void(0,c.A)(N,this,t);(0,o.A)(D,this).notify("load-start");const e=(0,h.A)(U,this,At).call(this,t),i=await this.session.loadMedia(e);if(i)return(0,c.A)(N,this,null),void(0,o.A)(D,this).notify("error",Error((0,A.tM)(i)));(0,c.A)(N,this,t)}destroy(){(0,h.A)(U,this,Y).call(this),(0,h.A)(U,this,Q).call(this)}}function z(){(0,A.It)(cast.framework.CastContextEventType.CAST_STATE_CHANGED,(0,h.A)(U,this,K).bind(this))}function J(){const t=cast.framework.RemotePlayerEventType,s={[t.IS_CONNECTED_CHANGED]:(0,h.A)(U,this,K),[t.IS_MEDIA_LOADED_CHANGED]:(0,h.A)(U,this,j),[t.CAN_CONTROL_VOLUME_CHANGED]:(0,h.A)(U,this,Z),[t.CAN_SEEK_CHANGED]:(0,h.A)(U,this,tt),[t.DURATION_CHANGED]:(0,h.A)(U,this,it),[t.IS_MUTED_CHANGED]:(0,h.A)(U,this,at),[t.VOLUME_LEVEL_CHANGED]:(0,h.A)(U,this,at),[t.IS_PAUSED_CHANGED]:(0,h.A)(U,this,nt),[t.LIVE_SEEKABLE_RANGE_CHANGED]:(0,h.A)(U,this,ht),[t.PLAYER_STATE_CHANGED]:(0,h.A)(U,this,ot)};(0,c.A)($,this,s);const e=(0,h.A)(U,this,q).bind(this);for(const i of(0,r.YD)(s))(0,o.A)(b,this).controller.addEventListener(i,e);(0,r.zp)(()=>{for(const t of(0,r.YD)(s))(0,o.A)(b,this).controller.removeEventListener(t,e)})}function Y(){(0,o.A)(V,this)||((0,c.A)(R,this,0),(0,c.A)(W,this,new l.zJ(0,0))),(0,o.A)(O,this).stop(),(0,c.A)(G,this,0),(0,c.A)(V,this,null)}function F(){var t;const s=new r.vP("resume-session",{detail:this.session});(0,h.A)(U,this,j).call(this,s);const{muted:e,volume:i,savedState:a}=(0,o.A)(D,this).$state,n=a();this.setCurrentTime(Math.max((0,o.A)(b,this).currentTime,null!==(t=null===n||void 0===n?void 0:n.currentTime)&&void 0!==t?t:0)),this.setMuted(e()),this.setVolume(i()),!1===(null===n||void 0===n?void 0:n.paused)&&this.play()}function Q(){this.cast.endCurrentSession(!0);const{remotePlaybackLoader:t}=(0,o.A)(D,this).$state;t.set(null)}function X(){const{savedState:t}=(0,o.A)(D,this).$state;t.set({paused:(0,o.A)(b,this).isPaused,currentTime:(0,o.A)(b,this).currentTime}),(0,h.A)(U,this,Q).call(this)}function B(){(0,h.A)(U,this,et).call(this)}function q(t){(0,o.A)($,this)[t.type].call(this,t)}function K(t){const s=this.cast.getCastState(),e=s===cast.framework.CastState.CONNECTED?"connected":s===cast.framework.CastState.CONNECTING?"connecting":"disconnected";if((0,o.A)(P,this)===e)return;const i={type:"google-cast",state:e},a=(0,h.A)(U,this,rt).call(this,t);(0,c.A)(P,this,e),(0,o.A)(D,this).notify("remote-playback-change",i,a),"disconnected"===e&&(0,h.A)(U,this,X).call(this)}function j(t){if(!!!(0,o.A)(b,this).isMediaLoaded)return;const s=(0,r.se)((0,o.A)(D,this).$state.source);Promise.resolve().then(()=>{if(s!==(0,r.se)((0,o.A)(D,this).$state.source)||!(0,o.A)(b,this).isMediaLoaded)return;(0,h.A)(U,this,Y).call(this);const e=(0,o.A)(b,this).duration;(0,c.A)(W,this,new l.zJ(0,e));const i={provider:this,duration:e,buffered:new l.zJ(0,0),seekable:(0,h.A)(U,this,ct).call(this)},a=(0,h.A)(U,this,rt).call(this,t);(0,o.A)(D,this).notify("loaded-metadata",void 0,a),(0,o.A)(D,this).notify("loaded-data",void 0,a),(0,o.A)(D,this).notify("can-play",i,a),(0,h.A)(U,this,Z).call(this),(0,h.A)(U,this,tt).call(this,t);const{volume:n,muted:A}=(0,o.A)(D,this).$state;this.setVolume(n()),this.setMuted(A()),(0,o.A)(O,this).start(),(0,o.A)(_,this).syncRemoteTracks(a),(0,o.A)(_,this).syncRemoteActiveIds(a)})}function Z(){(0,o.A)(D,this).$state.canSetVolume.set((0,o.A)(b,this).canControlVolume)}function tt(t){const s=(0,h.A)(U,this,rt).call(this,t);(0,o.A)(D,this).notify("stream-type-change",(0,h.A)(U,this,st).call(this),s)}function st(){var t;return(null===(t=(0,o.A)(b,this).mediaInfo)||void 0===t?void 0:t.streamType)===chrome.cast.media.StreamType.LIVE?(0,o.A)(b,this).canSeek?"live:dvr":"live":"on-demand"}function et(){if((0,o.A)(V,this))return;const t=(0,o.A)(b,this).currentTime;t!==(0,o.A)(G,this)&&((0,o.A)(D,this).notify("time-change",t),t>(0,o.A)(R,this)&&((0,c.A)(R,this,t),(0,h.A)(U,this,ht).call(this)),(0,o.A)(D,this).$state.seeking()&&(0,o.A)(D,this).notify("seeked",t),(0,c.A)(G,this,t))}function it(t){if(!(0,o.A)(b,this).isMediaLoaded||(0,o.A)(V,this))return;const s=(0,o.A)(b,this).duration,e=(0,h.A)(U,this,rt).call(this,t);(0,c.A)(W,this,new l.zJ(0,s)),(0,o.A)(D,this).notify("duration-change",s,e)}function at(t){if(!(0,o.A)(b,this).isMediaLoaded)return;const s={muted:(0,o.A)(b,this).isMuted,volume:(0,o.A)(b,this).volumeLevel},e=(0,h.A)(U,this,rt).call(this,t);(0,o.A)(D,this).notify("volume-change",s,e)}function nt(t){const s=(0,h.A)(U,this,rt).call(this,t);(0,o.A)(b,this).isPaused?(0,o.A)(D,this).notify("pause",void 0,s):(0,o.A)(D,this).notify("play",void 0,s)}function ht(t){const s={seekable:(0,h.A)(U,this,ct).call(this),buffered:new l.zJ(0,(0,o.A)(R,this))},e=t?(0,h.A)(U,this,rt).call(this,t):void 0;(0,o.A)(D,this).notify("progress",s,e)}function ot(t){const s=(0,o.A)(b,this).playerState,e=chrome.cast.media.PlayerState;if((0,c.A)(H,this,s===e.IDLE),s===e.PAUSED)return;const i=(0,h.A)(U,this,rt).call(this,t);switch(s){case e.PLAYING:(0,o.A)(D,this).notify("playing",void 0,i);break;case e.BUFFERING:(0,o.A)(D,this).notify("waiting",void 0,i);break;case e.IDLE:(0,o.A)(O,this).stop(),(0,o.A)(D,this).notify("pause"),(0,o.A)(D,this).notify("end")}}function ct(){return(0,o.A)(b,this).liveSeekableRange?new l.zJ((0,o.A)(b,this).liveSeekableRange.start,(0,o.A)(b,this).liveSeekableRange.end):(0,o.A)(W,this)}function rt(t){return t instanceof Event?t:new r.vP(t.type,{detail:t})}function lt(t){const{streamType:s,title:e,poster:i}=(0,o.A)(D,this).$state;return new m(t).setMetadata(e(),i()).setStreamType(s()).setTracks((0,o.A)(_,this).getLocalTextTracks()).build()}function At(t){var s,e,i,a,n;const c=(0,h.A)(U,this,lt).call(this,t),r=new chrome.cast.media.LoadRequest(c),l=(0,o.A)(D,this).$state.savedState();return r.autoplay=!1===(null!==(s=null===(e=(0,o.A)(V,this))||void 0===e?void 0:e.paused)&&void 0!==s?s:null===l||void 0===l?void 0:l.paused),r.currentTime=null!==(i=null!==(a=null===(n=(0,o.A)(V,this))||void 0===n?void 0:n.time)&&void 0!==a?a:null===l||void 0===l?void 0:l.currentTime)&&void 0!==i?i:0,r}async function dt(t,s){const e=(0,r.se)((0,o.A)(D,this).$state.source);(0,c.A)(V,this,{src:e,paused:t,time:s}),await this.loadSource(e)}function ut(){(0,h.A)(U,this,dt).call(this,(0,o.A)(b,this).isPaused,(0,o.A)(b,this).currentTime).catch(t=>{})}}}]);
//# sourceMappingURL=146.9e4169a2.chunk.js.map